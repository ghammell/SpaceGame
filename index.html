<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Cosmic Drift</title>
  <link rel="icon" href="data:,">
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <header id="desktopHeader" class="desktop-header touch-hidden" aria-label="Game title">
    <div class="desktop-title">Cosmic Drift</div>
  </header>
  <main class="layout">
    <canvas id="gameCanvas" width="1400" height="800" aria-label="Gameplay canvas"></canvas>
  </main>
  <section class="info-row">
    <button id="toggleInstructions" class="info-button" aria-expanded="false" aria-controls="instructionsOverlay">Show Instructions</button>
    <button id="toggleHighScores" class="info-button" aria-expanded="false" aria-controls="highScoresOverlay">Show High Scores</button>
  </section>
  <section id="instructionsOverlay" class="modal-overlay hidden" aria-label="Instructions">
    <div class="modal-card">
      <div class="modal-header">
        <div class="summary-title small">How to Play</div>
        <button class="modal-close" data-close-target="instructionsOverlay" aria-label="Close instructions">×</button>
      </div>
      <div class="modal-body">
        <div class="modern-text">
          <strong>Objective:</strong> get the highest score possible. Stack powerups, destroy hazards, and survive as long as you can.
        </div>
        <div class="summary-title small">Controls</div>
        <div class="info-grid">
          <div class="info-tile">
            <div class="info-key">Up</div>
            <div class="info-desc">Thrust upward</div>
          </div>
          <div class="info-tile">
            <div class="info-key">Space (tap)</div>
            <div class="info-desc">Pause / resume during a run</div>
          </div>
          <div class="info-tile">
            <div class="info-key">F</div>
            <div class="info-desc">Fire blaster (when armed)</div>
          </div>
        </div>
        <div class="summary-title small modal-section-title">Positive Powerups</div>
        <div class="modern-text subtext">
          Advantages that help you survive and score more.
        </div>
        <div class="info-grid power-grid">
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/heart_plus.svg" alt="Extra life" /><div>Extra life</div><span>Gain 1 life</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/cloak.svg" alt="Explosive barrier" /><div>Explosive Barrier</div><span>Detonate hazards on contact</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/blaster.svg" alt="Blaster" /><div>Blaster</div><span>Unlimited shots while active</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/slow.svg" alt="Slow" /><div>Slow</div><span>Hazards move slower</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/forcefield.svg" alt="Force field" /><div>Force Field</div><span>Pulses clear nearby asteroids</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/wingman.svg" alt="Wingman" /><div>Wingman</div><span>Friendly alien fires at hazards</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/starstorm.svg" alt="Star storm" /><div>Star Storm</div><span>Shooting stars shred asteroids</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/orbitallaser.svg" alt="Orbital laser" /><div>Orbital Laser</div><span>3 pulse sweeps clear hazards</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/seeker.svg" alt="Seeker missiles" /><div>Seeker Missiles</div><span>Periodic homing missiles hit random hazards</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/missiles.svg" alt="Missile barrage" /><div>Missile Barrage</div><span>Delayed missiles clear asteroids + aliens</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/multiplier.svg" alt="Multiplier" /><div>Multiplier</div><span>Score x2</span></div>
        </div>
        <div class="summary-title small modal-section-title">Negative Powerups</div>
        <div class="modern-text subtext">
          Negative powerups make the game harder, but your score increases faster while they’re active and you earn a bonus when they end.
        </div>
        <div class="info-grid power-grid">
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/splitter.svg" alt="Asteroid splitter" /><div>Asteroid Splitter</div><span>Asteroids shatter into smaller ones, bonus points</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/spacedust.svg" alt="Space dust" /><div>Space Dust</div><span>Obscures vision, bonus points</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/blackhole.svg" alt="Black hole" /><div>Black Hole</div><span>Faster hazards, bonus points</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/solarflare.svg" alt="Solar flare" /><div>Solar Flare</div><span>Larger hazards, bonus points</span></div>
          <div class="power-tile"><img class="summary-icon" src="./assets/powerups/wave.svg" alt="Wave" /><div>Wave</div><span>Bobbing hazards, bonus points</span></div>
        </div>
      </div>
    </div>
  </section>
  <section id="highScoresOverlay" class="modal-overlay hidden" aria-label="High scores">
    <div class="modal-card">
      <div class="modal-header">
        <div class="summary-title small">Top 10</div>
        <button class="modal-close" data-close-target="highScoresOverlay" aria-label="Close high scores">×</button>
      </div>
      <div class="modal-body">
        <ul id="inlineHighScores" class="summary-list"></ul>
      </div>
    </div>
  </section>
  <section id="startOverlay" class="modal-overlay visible" aria-label="Start game">
    <div class="modal-card start-card">
      <div class="start-hero">
        <img src="./assets/spaceman.svg" class="start-spaceman" alt="Spaceman" />
        <div class="start-title">Cosmic Drift</div>
        <div class="start-subtitle">Press Space or click Start.</div>
        <div class="start-message">Welcome, pilot. Dodge the field, stack powerups, chase the high score.</div>
      </div>
      <div class="start-actions">
        <button id="startPlayButton" class="summary-button">Start</button>
        <button id="startInstructionsButton" class="info-button ghost">View Instructions</button>
        <button id="startTestModeButton" class="info-button ghost">Test Mode</button>
      </div>
    </div>
  </section>
  <section id="rotateOverlay" class="modal-overlay hidden rotate-overlay" aria-label="Rotate device">
    <div class="modal-card start-card">
      <div class="start-title">Rotate to play</div>
      <div class="start-subtitle">Please rotate your device to landscape.</div>
    </div>
  </section>
  <section id="pauseOverlay" class="modal-overlay hidden" aria-label="Paused">
    <div class="modal-card start-card">
      <div class="start-title">Paused</div>
      <div class="start-subtitle">Press Space or click Resume to continue.</div>
      <div class="start-actions">
        <button id="pauseResumeButton" class="summary-button">Resume</button>
      </div>
    </div>
  </section>

  <!-- Intermediary pre-run modal (shown before starting a new run, after the first run). -->
  <section id="runSetupOverlay" class="modal-overlay hidden run-setup-overlay" aria-label="Run setup">
    <div class="modal-card start-card">
      <div class="start-title">Ready?</div>
      <div class="start-subtitle">Press Space or click Start.</div>
      <div class="start-message">Start a new run, or tweak things first.</div>
      <div class="start-actions">
        <button id="runSetupStartButton" class="summary-button">Start</button>
        <button id="runSetupInstructionsButton" class="info-button ghost">View Instructions</button>
        <div class="run-setup-testmode-row">
          <button id="runSetupTestModeButton" class="info-button ghost" type="button">Test Mode</button>
          <button id="runSetupDeactivateTestModeButton" class="info-button ghost run-setup-deactivate-button" type="button">Deactivate</button>
        </div>
      </div>
    </div>
  </section>

  <!-- Full test mode config modal (only shown when the user clicks into it). -->
  <section id="testModeOverlay" class="modal-overlay hidden" aria-label="Test mode">
    <div class="modal-card">
      <div class="modal-header">
        <div class="summary-title small">Test Mode</div>
          <button id="closeTestMode" class="modal-close" data-close-target="testModeOverlay" aria-label="Close test mode">×</button>
      </div>
      <div class="modal-body">
        <div class="modern-text">
          Settings apply immediately. Test mode disables saving high scores.
        </div>
        <div class="testmode-section">
          <div class="summary-title small modal-section-title">Test Mode</div>
          <div class="modern-text subtext">
            When disabled, all other settings are ignored.
          </div>
          <label class="testmode-row">
            <input id="testModeEnabled" type="checkbox" />
            Enable test mode
          </label>
        </div>
        <div class="testmode-section">
          <div class="summary-title small modal-section-title">Infinite Lives</div>
          <div class="modern-text subtext">
            Only applies when test mode is enabled.
          </div>
          <label class="testmode-row">
            <input id="testModeInfiniteLives" type="checkbox" />
            Infinite lives
          </label>
        </div>
        <div class="testmode-section">
          <div class="summary-title small modal-section-title">Asteroid Tuning</div>
          <div class="modern-text subtext">
            These sliders are multipliers on top of the normal game behavior. <strong>1.00×</strong> is the default.
          </div>
          <div class="testmode-sliders">
            <div class="testmode-slider-row">
              <div class="testmode-slider-meta">
                <div class="testmode-slider-label">Asteroid speed</div>
                <div id="testAsteroidSpeedValue" class="testmode-slider-value">1.00×</div>
              </div>
              <input id="testAsteroidSpeedMultiplier" class="testmode-range" type="range" min="0.5" max="2.5" step="0.05" value="1" />
            </div>
            <div class="testmode-slider-row">
              <div class="testmode-slider-meta">
                <div class="testmode-slider-label">Asteroid size</div>
                <div id="testAsteroidSizeValue" class="testmode-slider-value">1.00×</div>
              </div>
              <input id="testAsteroidSizeMultiplier" class="testmode-range" type="range" min="0.6" max="2" step="0.05" value="1" />
            </div>
            <div class="testmode-slider-row">
              <div class="testmode-slider-meta">
                <div class="testmode-slider-label">Asteroid spawn rate</div>
                <div id="testAsteroidSpawnRateValue" class="testmode-slider-value">1.00×</div>
              </div>
              <input id="testAsteroidSpawnRateMultiplier" class="testmode-range" type="range" min="0.5" max="3" step="0.05" value="1" />
            </div>
            <div class="testmode-slider-row">
              <div class="testmode-slider-meta">
                <div class="testmode-slider-label">Powerup spawn rate</div>
                <div id="testPowerupSpawnRateValue" class="testmode-slider-value">1.00×</div>
              </div>
              <input id="testPowerupSpawnRateMultiplier" class="testmode-range" type="range" min="0.5" max="3" step="0.05" value="1" />
            </div>
          </div>
        </div>
        <div class="testmode-section">
          <div class="summary-title small modal-section-title">Positive Powerups</div>
          <div class="modern-text subtext">
            Advantages that help you survive and score more.
          </div>
          <div class="testmode-grid">
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="extraLife" /> <img class="testmode-icon" src="./assets/powerups/heart_plus.svg" alt="" aria-hidden="true" /> Extra Life <span class="testmode-desc">Gain one life</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="cloak" /> <img class="testmode-icon" src="./assets/powerups/cloak.svg" alt="" aria-hidden="true" /> Explosive Barrier <span class="testmode-desc">Detonate hazards on contact</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="blaster" /> <img class="testmode-icon" src="./assets/powerups/blaster.svg" alt="" aria-hidden="true" /> Blaster <span class="testmode-desc">Fire while active</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="slow" /> <img class="testmode-icon" src="./assets/powerups/slow.svg" alt="" aria-hidden="true" /> Slow <span class="testmode-desc">Hazards move slower</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="forceField" /> <img class="testmode-icon" src="./assets/powerups/forcefield.svg" alt="" aria-hidden="true" /> Force Field <span class="testmode-desc">Pulses clear nearby asteroids</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="allyAlien" /> <img class="testmode-icon" src="./assets/powerups/wingman.svg" alt="" aria-hidden="true" /> Wingman <span class="testmode-desc">Friendly alien fires at hazards</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="shootingStarStorm" /> <img class="testmode-icon" src="./assets/powerups/starstorm.svg" alt="" aria-hidden="true" /> Star Storm <span class="testmode-desc">Shooting stars shred asteroids</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="orbitalLaser" /> <img class="testmode-icon" src="./assets/powerups/orbitallaser.svg" alt="" aria-hidden="true" /> Orbital Laser <span class="testmode-desc">3 pulse sweeps clear hazards</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="seekerMissiles" /> <img class="testmode-icon" src="./assets/powerups/seeker.svg" alt="" aria-hidden="true" /> Seeker Missiles <span class="testmode-desc">Periodic homing missiles</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="missileBarrage" /> <img class="testmode-icon" src="./assets/powerups/missiles.svg" alt="" aria-hidden="true" /> Missile Barrage <span class="testmode-desc">Delayed missiles clear asteroids + aliens</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="multiplier" /> <img class="testmode-icon" src="./assets/powerups/multiplier.svg" alt="" aria-hidden="true" /> Multiplier <span class="testmode-desc">Score x2</span></label>
          </div>

          <div class="summary-title small modal-section-title">Negative Powerups</div>
          <div class="modern-text subtext">
            Harder run, faster score. Bonus points awarded when the effect ends.
          </div>
          <div class="testmode-grid">
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="asteroidSplitter" /> <img class="testmode-icon" src="./assets/powerups/splitter.svg" alt="" aria-hidden="true" /> Asteroid Splitter <span class="testmode-desc">Asteroids shatter into smaller ones</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="spaceDust" /> <img class="testmode-icon" src="./assets/powerups/spacedust.svg" alt="" aria-hidden="true" /> Space Dust <span class="testmode-desc">Vision obscured (bonus points)</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="blackHole" /> <img class="testmode-icon" src="./assets/powerups/blackhole.svg" alt="" aria-hidden="true" /> Black Hole <span class="testmode-desc">Faster hazards (bonus points)</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="solarFlare" /> <img class="testmode-icon" src="./assets/powerups/solarflare.svg" alt="" aria-hidden="true" /> Solar Flare <span class="testmode-desc">Larger hazards (bonus points)</span></label>
            <label class="testmode-row"><input class="testmode-powerup" type="checkbox" value="wave" /> <img class="testmode-icon" src="./assets/powerups/wave.svg" alt="" aria-hidden="true" /> Wave <span class="testmode-desc">Bobbing hazards (bonus points)</span></label>
          </div>
          <div class="testmode-help">If no powerups are selected, all powerups are allowed while test mode is enabled.</div>
        </div>
      </div>
    </div>
  </section>
  <section id="summaryOverlay" class="summary-overlay" aria-label="Game summary">
    <div class="summary-card">
      <div class="summary-scroll">
        <div class="summary-stack">
          <div class="summary-title">Mission Debrief</div>

          <div class="summary-section collapsed" id="scoreSection">
            <button class="summary-toggle" type="button" aria-expanded="false">
              <span>Total Score</span>
              <span class="summary-value" id="summaryScore">0</span>
              <span class="chevron">▸</span>
            </button>
            <div class="summary-details">
              <div class="summary-row summary-sub">
                <span><img class="summary-icon" src="./assets/hud-score.svg" alt="Time" />Time score</span>
                <span id="summaryTimeScore">0</span>
              </div>
              <div class="summary-row summary-sub">
                <span><img class="summary-icon" src="./assets/asteroids/asteroid1.svg" alt="Asteroids" />Destroyed score</span>
                <span id="summaryDestroyedScore">0</span>
              </div>
              <div class="summary-row summary-sub">
                <span><img class="summary-icon" src="./assets/powerups/cloak.svg" alt="Barrier" />Barrier score</span>
                <span id="summaryPhasedScore">0</span>
              </div>
              <div class="summary-row summary-sub">
                <span><img class="summary-icon" src="./assets/powerups/multiplier.svg" alt="Misc" />Misc score</span>
                <span id="summaryMiscScore">0</span>
              </div>
              <div class="summary-row summary-sub">
                <span><img class="summary-icon" src="./assets/powerups/blackhole.svg" alt="Negative" />Negative bonus</span>
                <span id="summaryNegativeScore">0</span>
              </div>
            </div>
          </div>

          <div class="summary-row"><span>Time survived</span><span id="summaryTime">0s</span></div>
          <div class="summary-row"><span>Powerups collected</span><span id="summaryPowerups">0</span></div>

          <div class="summary-section collapsed" id="uptimeSection">
            <button class="summary-toggle" type="button" aria-expanded="false">
              <span>Uptime</span>
              <span class="chevron">▸</span>
            </button>
            <div class="summary-details">
              <div class="summary-row"><span>Barrier uptime</span><span id="summaryCloak">0s</span></div>
              <div class="summary-row"><span>Blaster uptime</span><span id="summaryBlaster">0s</span></div>
              <div class="summary-row"><span>Slow uptime</span><span id="summarySlow">0s</span></div>
            </div>
          </div>

          <div class="summary-row notice-row" id="summaryTestModeNotice" style="display: none;">
            <span>High score</span>
            <span>Unavailable in test mode</span>
          </div>
          <div class="summary-section" id="summaryHighScoreSection">
            <button class="summary-toggle" type="button" aria-expanded="true">
              <span>High Scores</span>
              <span class="chevron">▾</span>
            </button>
            <div class="summary-details">
              <div class="summary-inline" id="summarySaveInline">
                <label for="summaryNameInput" class="summary-inline-label">Name</label>
                <input id="summaryNameInput" class="summary-input" type="text" maxlength="18" placeholder="Your name" />
                <button id="summarySaveButton" class="summary-button small" aria-label="Save high score">Save</button>
              </div>
              <ul id="summaryHighScores" class="summary-list"></ul>
            </div>
          </div>
        </div>
      </div>
      <button id="summaryRestart" class="summary-button" aria-label="Restart run">Start New Run</button>
    </div>
  </section>
  <script type="module" src="./src/main.js"></script>
</body>
</html>

